# Generated by https://smithery.ai. See: https://smithery.ai/docs/config#dockerfile
FROM python:3.10-slim

# Install OSINT tools dependencies
RUN apt-get update && \
    apt-get install -y whois nmap dnsrecon dnstwist dnsutils host && \
    rm -rf /var/lib/apt/lists/*

# Install uv globally as root
RUN pip install uv

# Create and switch to a non-root user

WORKDIR /app

# Copy dependency definition files
COPY requirements.txt ./
COPY setup.py ./

# Install dependencies
RUN uv pip install --system --no-cache -r requirements.txt .

# Copy the rest of the application code
COPY mcp_osint_server/ ./mcp_osint_server/
ENV PYTHONPATH=/app

RUN useradd -m mcpuser
USER mcpuser

EXPOSE 3000

# Set the entrypoint to the MCP server startup command provided by setup.py
ENTRYPOINT ["mcp-osint"]
